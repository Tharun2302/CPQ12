FROM alpine:latest

# Install LibreOffice and Node.js
RUN apk add --no-cache \
    libreoffice \
    nodejs \
    npm \
    python3 \
    py3-pip

# Create app directory
WORKDIR /app

# Create the conversion service
COPY libreoffice-converter.js /app/converter.js

# Install required Node.js packages locally so require() can resolve them
RUN npm init -y && npm install express multer cors

# Create temp directories
RUN mkdir -p /temp/input /temp/output

# Expose port
EXPOSE 3000

# Start the service
CMD ["node", "/app/converter.js"]
